<!DOCTYPE html>
<html>
    <head>
        <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
        <!-- ar.js -->
        <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"> </script>
        <script src="https://unpkg.com/ar.js@3.3.0"></script>

        <!-- artoolkit-threex.js -->
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/three.js/build/ar.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/three.js/examples/js/loaders/OBJLoader.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/three.js/examples/js/loaders/MTLLoader.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/three.js/examples/js/renderers/Projector.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/three.js/examples/js/renderers/CanvasRenderer.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/aframe/build/aframe-ar.js"></script>

    </head>
    <body>
        <a-scene renderer="colorManagement: true">

            <a-camera>
                <a-cursor></a-cursor>
            </a-camera>

            <a-assets>
                <a-asset-item id="car1" src="glb/car_1.glb"></a-asset-item>
            </a-assets>

            <!-- <a-entity gltf-model="#car1"></a-entity> -->
            <a-entity threex-plane-detector (detected)="onDetected(event)">
                <a-entity id="car-1" gltf-model="#car1"></a-entity>
            </a-entity> 

        </a-scene>
    </body>

    <script>
        function onDetected(event) {
            const planeWidth = event.detail.width;
            const planeHeight = event.detail.height;

            // 평면과 가상 객체의 크기 비율 계산
            const objectWidth = 0.1; // 가상 객체의 너비
            const objectHeight = 0.1; // 가상 객체의 높이
            const widthRatio = planeWidth / objectWidth;
            const heightRatio = planeHeight / objectHeight;
            const scale = `${widthRatio} ${heightRatio} 1`;

            // 가상 객체의 scale 속성 설정
            const model = document.querySelector('#car-1');
            model.setAttribute('scale', scale);
        }
    </script>
</html>